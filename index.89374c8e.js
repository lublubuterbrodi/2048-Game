const t=new class{constructor(t=null){this.size=4,this.board=t||this.createEmptyBoard(),this.score=0,this.status="idle"}createEmptyBoard(){return Array.from({length:this.size},()=>Array(this.size).fill(0))}addRandomTile(){let t=[];for(let e=0;e<this.size;e++)for(let s=0;s<this.size;s++)0===this.board[e][s]&&t.push([e,s]);if(t.length>0){let[e,s]=t[Math.floor(Math.random()*t.length)],r=.9>Math.random()?2:4;this.board[e][s]=r}}restart(){this.board=this.createEmptyBoard(),this.score=0,this.status="playing",this.addRandomTile(),this.addRandomTile()}start(){"idle"===this.status&&this.restart()}getState(){return this.board}getScore(){return this.score}getStatus(){return this.status}canMove(){for(let t=0;t<this.size;t++)for(let e=0;e<this.size;e++)if(0===this.board[t][e]||e<this.size-1&&this.board[t][e]===this.board[t][e+1]||t<this.size-1&&this.board[t][e]===this.board[t+1][e])return!0;return!1}rotateBoard(t=!0){let e=this.createEmptyBoard();for(let s=0;s<this.size;s++)for(let r=0;r<this.size;r++)t?e[r][this.size-s-1]=this.board[s][r]:e[this.size-r-1][s]=this.board[s][r];this.board=e}slideAndMergeRow(t){let e=t.filter(t=>0!==t);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,e[t+1]=0,this.score+=e[t]);return e.filter(t=>0!==t)}moveLeft(){let t=!1;for(let e=0;e<this.size;e++){let s=[...this.board[e]],r=this.slideAndMergeRow(s);this.board[e]=[...r,...Array(this.size-r.length).fill(0)],t||s.toString()===this.board[e].toString()||(t=!0)}t&&(this.addRandomTile(),this.checkGameOver())}moveRight(){this.board.forEach(t=>t.reverse()),this.moveLeft(),this.board.forEach(t=>t.reverse())}moveUp(){this.rotateBoard(!1),this.moveLeft(),this.rotateBoard(!0)}moveDown(){this.rotateBoard(!0),this.moveLeft(),this.rotateBoard(!1)}checkGameOver(){for(let t=0;t<this.size;t++)for(let e=0;e<this.size;e++)if(2048===this.board[t][e]){this.status="win";return}this.canMove()||(this.status="lose")}},e=document.querySelector(".button.start"),s=document.querySelector(".game-score"),r=document.querySelector(".message-win"),i=document.querySelector(".message-lose"),o=document.querySelector(".message-start");function a(){let o=t.getState();s.textContent=t.getScore();let a=document.querySelectorAll(".field-cell"),d=0;for(let t=0;t<4;t++)for(let e=0;e<4;e++){let s=o[t][e],r=a[d];r.className="field-cell",r.textContent=s>0?s:"",s>0&&r.classList.add(`field-cell--${s}`),d++}"win"===t.getStatus()?(r.classList.remove("hidden"),i.classList.add("hidden"),e.textContent="Restart"):"lose"===t.getStatus()&&(i.classList.remove("hidden"),r.classList.add("hidden"),e.textContent="Restart")}document.addEventListener("keydown",e=>{if("playing"===t.getStatus()){switch(e.key){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown()}a()}}),e.addEventListener("click",()=>{t.restart(),a(),o.classList.add("hidden"),r.classList.add("hidden"),i.classList.add("hidden"),e.textContent="Restart",e.style.fontSize="16px",e.classList.remove("start"),e.classList.add("restart"),e.blur()});
//# sourceMappingURL=index.89374c8e.js.map
